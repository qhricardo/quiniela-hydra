<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Comprar Cr√©ditos</title>
  <script src="https://sdk.mercadopago.com/js/v2"></script>
</head>
<body>
  <h2>Comprar Cr√©ditos Quiniela360</h2>

  <label>Nombre:</label>
  <input type="text" id="nombre" value="Edensin Quintero"><br><br>

  <label>User ID:</label>
  <input type="text" id="userId" value="u12345"><br><br>

  <label>Cr√©ditos:</label>
  <select id="creditos">
    <option value="5">5 cr√©ditos - $5 MXN</option>
    <option value="10">10 cr√©ditos - $10 MXN</option>
    <option value="20">20 cr√©ditos - $20 MXN</option>
  </select><br><br>

  <button id="btnPagar">üí≥ Pagar</button>

  <script>
    const mp = new MercadoPago("TEST-XXXXXXXXXXXXXXXXXXXXXXXXX", { locale: "es-MX" }); // ‚ö†Ô∏è Reemplaza con tu PUBLIC_KEY

    document.getElementById("btnPagar").addEventListener("click", async () => {
      const nombre = document.getElementById("nombre").value;
      const userId = document.getElementById("userId").value;
      const creditos = parseInt(document.getElementById("creditos").value);
      const monto = creditos; // 1 cr√©dito = 1 MXN

      // üü¢ Env√≠a los datos al servidor
      const res = await fetch("/crear-preferencia", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ nombre, userId, creditos, monto })
      });

      const data = await res.json();

      if (data.init_point) {
        window.location.href = data.init_point; // Redirige al pago
      } else {
        alert("Error al crear preferencia de pago");
        console.log(data);
      }
    });
  </script>
</body>
</html>
