<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Quiniela 360</title>
<style>
body {
    font-family: 'Arial', sans-serif;
    margin: 0;
    background: #f5f5f5;
    display: flex;
    justify-content: center;
}

/* LOGIN AL LADO DERECHO */
.login-container {
    position: fixed;
    right: 20px;
    top: 50px;
    width: 250px;
    background: white;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
}
.login-container input {
    width: 100%;
    padding: 8px;
    margin-bottom: 5px;
    border-radius: 5px;
    border: 1px solid #ccc;
}
.login-container button {
    width: 100%;
    padding: 8px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    background: #006847;
    color: white;
    margin-bottom: 5px;
}
.login-container button:hover { background: #004d33; }

/* MAIN CONTENT */
main {
    max-width: 1000px;
    margin: 20px 0;
    width: 100%;
}

/* NOTICIAS */
#noticias {
    display: flex;
    flex-direction: column;
    gap: 15px;
}
.noticia {
    display: flex;
    gap: 15px;
    background: #fff;
    padding: 10px;
    border-radius: 8px;
    flex-wrap: wrap;
}
.noticia img {
    width: 150px;
    height: 90px;
    object-fit: cover;
    border-radius: 5px;
}
.noticia .contenido {
    flex: 1;
}
.noticia iframe {
    width: 300px;
    height: 170px;
    border-radius: 5px;
}

/* TABLA GENERAL */
#tablaGeneral {
    width: 100%;
    max-width: 600px;
    margin: 20px auto 40px;
    border-collapse: collapse;
}
#tablaGeneral th, #tablaGeneral td {
    border: 1px solid #ccc;
    padding: 10px;
    text-align: center;
}
#tablaGeneral th { background: #006847; color: white; }
</style>
</head>
<body>

<!-- LOGIN LADO DERECHO -->
<div class="login-container">
    <form id="login-form">
        <input type="email" id="email" placeholder="Correo electrÃ³nico" required>
        <input type="password" id="password" placeholder="ContraseÃ±a" required>
        <button type="submit">Iniciar sesiÃ³n</button>
    </form>
    <button id="google-login" style="background:#4285F4;">Entrar con Google</button>
</div>

<main>
    <h2 style="text-align:center; margin-top:20px;">ðŸ“° Ãšltimas Noticias de FÃºtbol</h2>
    <div id="noticias">Cargando noticias...</div>

    <h2 style="text-align:center;">âš½ Tabla General Liga MX</h2>
    <table id="tablaGeneral">
        <thead>
            <tr><th>Pos</th><th>Equipo</th><th>Puntos</th></tr>
        </thead>
        <tbody>
            <tr><td colspan="3">Cargando...</td></tr>
        </tbody>
    </table>
</main>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
<script src="js/firebase-config.js"></script>

<script>
const db = firebase.firestore();
const urlParams = new URLSearchParams(window.location.search);
const referrerId = urlParams.get("ref");

// LOGIN CORREO
document.getElementById('login-form').addEventListener('submit', async e => {
    e.preventDefault();
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    try {
        await firebase.auth().signInWithEmailAndPassword(email,password);
        window.location.href="interfaz.html";
    } catch(e){ alert(e.message); }
});

// LOGIN GOOGLE
document.getElementById('google-login').addEventListener('click', async () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    try { await firebase.auth().signInWithPopup(provider); window.location.href="interfaz.html"; }
    catch(e){ alert(e.message); }
});

// NOTICIAS CON IMAGEN Y VIDEOS
async function cargarNoticias() {
    const rssUrl = 'https://www.espn.com.mx/espn/rss/news';
    try {
        const resp = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(rssUrl)}`);
        const data = await resp.json();
        const xml = new DOMParser().parseFromString(data.contents,"text/xml");
        const items = xml.querySelectorAll("item");
        let html = '';
        items.forEach((item,i)=>{
            if(i<5){
                const title = item.querySelector("title").textContent;
                const link = item.querySelector("link").textContent;
                const media = item.querySelector("media\\:thumbnail, thumbnail");
                const img = media ? media.getAttribute("url") : "https://via.placeholder.com/150x90?text=FÃºtbol";
                const video = `https://www.youtube.com/embed?listType=search&list=${encodeURIComponent(title)}`;
                html += `<div class="noticia">
                    <img src="${img}" alt="noticia">
                    <div class="contenido">
                        <h3>${title}</h3>
                        <p><a href="${link}" target="_blank">Ver noticia completa</a></p>
                        <iframe src="${video}" frameborder="0" allowfullscreen></iframe>
                    </div>
                </div>`;
            }
        });
        document.getElementById('noticias').innerHTML = html;
    } catch(err){ console.error(err); document.getElementById('noticias').innerHTML='Error al cargar noticias'; }
}

// TABLA GENERAL LIGA MX
async function cargarTabla() {
    try {
        const res = await fetch("https://api-football-standings.azharimm.site/leagues/mex.1/standings");
        const data = await res.json();
        const tbody = document.querySelector("#tablaGeneral tbody");
        tbody.innerHTML = '';
        data.data.standings.forEach((team,i)=>{
            tbody.innerHTML += `<tr>
                <td>${i+1}</td>
                <td>${team.team.name}</td>
                <td>${team.stats.find(s=>s.name==='points')?.value || 0}</td>
            </tr>`;
        });
    } catch(err){ console.error(err); document.querySelector("#tablaGeneral tbody").innerHTML='<tr><td colspan="3">Error al cargar tabla</td></tr>'; }
}

cargarNoticias();
cargarTabla();
setInterval(cargarTabla,10*60*1000); // actualizar cada 10 minutos
</script>

</body>
</html>
